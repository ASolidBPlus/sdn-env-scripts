#!/usr/bin/env bash
# mn-host — Attach to a Mininet host and set title + prompt

set -euo pipefail

if [ $# -ne 1 ]; then
  echo "Usage: $(basename "$0") <mininet-host>" >&2
  exit 1
fi

HOST="$1"

# Find the namespace PID
PID=$(pgrep -f "mininet:${HOST}") || {
  echo "❌ Mininet host '$HOST' not found." >&2
  exit 1
}

# Set terminal tab title and custom PS1
sudo mnexec -a "$PID" env bash --norc --noprofile -i <<EOF
# Set tab title
echo -ne "\033]0;${HOST}@mininet\007"
# Set prompt
export PS1="\[\e[1;32m\]${HOST}@mininet:\w\$ \[\e[0m\]"
exec bash --norc --noprofile -i
EOF
